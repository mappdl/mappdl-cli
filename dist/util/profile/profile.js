var _0x9377df=_0x3b3d;(function(_0x33117e,_0x5c63a5){var _0x5c9cda=_0x3b3d,_0x2443ba=_0x33117e();while(!![]){try{var _0x251ec4=parseInt(_0x5c9cda(0x1d9))/0x1*(-parseInt(_0x5c9cda(0x1e1))/0x2)+-parseInt(_0x5c9cda(0x1e0))/0x3*(-parseInt(_0x5c9cda(0x1f4))/0x4)+parseInt(_0x5c9cda(0x1db))/0x5*(parseInt(_0x5c9cda(0x1ce))/0x6)+-parseInt(_0x5c9cda(0x1f3))/0x7*(-parseInt(_0x5c9cda(0x1d4))/0x8)+-parseInt(_0x5c9cda(0x205))/0x9+-parseInt(_0x5c9cda(0x200))/0xa*(-parseInt(_0x5c9cda(0x1cd))/0xb)+-parseInt(_0x5c9cda(0x1cb))/0xc*(parseInt(_0x5c9cda(0x1f6))/0xd);if(_0x251ec4===_0x5c63a5)break;else _0x2443ba['push'](_0x2443ba['shift']());}catch(_0x20c79f){_0x2443ba['push'](_0x2443ba['shift']());}}}(_0x3f32,0x6e35b));var __awaiter=this&&this[_0x9377df(0x201)]||function(_0x3b0c38,_0x530ce2,_0x5754d5,_0x19cadd){return new(_0x5754d5=_0x5754d5||Promise)(function(_0x496520,_0x3aece2){var _0x34d929=_0x3b3d;function _0x46ddc7(_0x2ed648){try{_0xc7c4af(_0x19cadd['next'](_0x2ed648));}catch(_0x432504){_0x3aece2(_0x432504);}}function _0x54a7bd(_0x49c0df){var _0x4bd911=_0x3b3d;try{_0xc7c4af(_0x19cadd[_0x4bd911(0x1f7)](_0x49c0df));}catch(_0x26df8c){_0x3aece2(_0x26df8c);}}function _0xc7c4af(_0x5beb55){var _0x5ddb65=_0x3b3d,_0x352819;_0x5beb55[_0x5ddb65(0x1cc)]?_0x496520(_0x5beb55['value']):((_0x352819=_0x5beb55[_0x5ddb65(0x1e6)])instanceof _0x5754d5?_0x352819:new _0x5754d5(function(_0x42a708){_0x42a708(_0x352819);}))[_0x5ddb65(0x1d0)](_0x46ddc7,_0x54a7bd);}_0xc7c4af((_0x19cadd=_0x19cadd[_0x34d929(0x1cf)](_0x3b0c38,_0x530ce2||[]))['next']());});};Object[_0x9377df(0x1f2)](exports,'__esModule',{'value':!0x0}),exports[_0x9377df(0x1d5)]=exports['saveUser']=exports[_0x9377df(0x1de)]=exports[_0x9377df(0x1d8)]=void 0x0;let fs=require('fs'),path=require(_0x9377df(0x1e3)),mkdirp=require(_0x9377df(0x1c5)),environments_1=require(_0x9377df(0x1d3)),misc_1=require(_0x9377df(0x1c6)),token_store_1=require('../token-store'),debug=require(_0x9377df(0x1c8))('mappdl-cli:util:profile:profile');class ProfileImpl{constructor(_0x10da37){var _0x4155f6=_0x9377df;this[_0x4155f6(0x202)]=_0x10da37['userId']||_0x10da37['id'],this[_0x4155f6(0x1fb)]=_0x10da37['userName']||_0x10da37[_0x4155f6(0x1fd)],this[_0x4155f6(0x1fa)]=_0x10da37[_0x4155f6(0x1fa)],this['email']=_0x10da37[_0x4155f6(0x1e9)],this[_0x4155f6(0x1da)]=_0x10da37[_0x4155f6(0x1da)],this[_0x4155f6(0x1d7)]=_0x10da37['defaultApp'],this[_0x4155f6(0x1df)]=_0x10da37[_0x4155f6(0x1df)]||!0x1;}get[_0x9377df(0x1f5)](){var _0x163ce9=_0x9377df;return token_store_1[_0x163ce9(0x1fe)][_0x163ce9(0x1f0)](this[_0x163ce9(0x1fb)])[_0x163ce9(0x1d0)](_0x53b316=>_0x53b316['accessToken']['id'])['catch'](_0x4b7aeb=>{var _0x280077=_0x163ce9;throw debug(_0x280077(0x1d6)+_0x4b7aeb[_0x280077(0x1ed)]),_0x4b7aeb;});}get['accessToken'](){var _0x2bd677=_0x9377df;return token_store_1[_0x2bd677(0x1fe)][_0x2bd677(0x1f0)](this[_0x2bd677(0x1fb)])['catch'](_0x410fca=>{var _0x579c2e=_0x2bd677;if(debug(_0x579c2e(0x1fc)+_0x410fca[_0x579c2e(0x1ed)]),_0x410fca[_0x579c2e(0x1ed)][_0x579c2e(0x1ee)](_0x579c2e(0x1c9)))return debug(_0x579c2e(0x1ca)),token_store_1[_0x579c2e(0x1fe)][_0x579c2e(0x1f0)](this[_0x579c2e(0x1fb)],!0x0);throw _0x410fca;})[_0x2bd677(0x1d0)](_0x5726e2=>_0x5726e2['accessToken'][_0x2bd677(0x1e7)])['catch'](_0x5b6b3e=>{var _0x56e6eb=_0x2bd677;throw debug(_0x56e6eb(0x204)+_0x5b6b3e[_0x56e6eb(0x1ed)]),_0x5b6b3e;});}get[_0x9377df(0x1e2)](){var _0x41c237=_0x9377df;return environments_1['environments'](this[_0x41c237(0x1da)])[_0x41c237(0x1e2)];}[_0x9377df(0x1f8)](){var _0x4aacf7=_0x9377df,_0x5556a3={'userId':this[_0x4aacf7(0x202)],'userName':this[_0x4aacf7(0x1fb)],'displayName':this[_0x4aacf7(0x1fa)],'email':this[_0x4aacf7(0x1e9)],'environment':this[_0x4aacf7(0x1da)],'defaultApp':this[_0x4aacf7(0x1d7)],'tokenSuppliedByUser':this['tokenSuppliedByUser']};return mkdirp[_0x4aacf7(0x1ef)](misc_1[_0x4aacf7(0x1dd)]()),fs[_0x4aacf7(0x1ea)](getProfileFilename(),JSON[_0x4aacf7(0x1f9)](_0x5556a3),{'encoding':'utf8'}),this;}[_0x9377df(0x1dc)](_0x3e172e){var _0x5ab289=_0x9377df;return token_store_1[_0x5ab289(0x1fe)][_0x5ab289(0x1e8)](this['userName'],_0x3e172e)[_0x5ab289(0x1d0)](()=>this);}[_0x9377df(0x1e4)](){return __awaiter(this,void 0x0,void 0x0,function*(){var _0x178038=_0x3b3d;yield token_store_1['tokenStore'][_0x178038(0x1ff)](this[_0x178038(0x1fb)]);try{fs['unlinkSync'](getProfileFilename());}catch(_0x2c4779){if('ENOENT'!==_0x2c4779[_0x178038(0x1d2)])throw _0x2c4779;}});}}function _0x3b3d(_0x4f1cf7,_0x762954){var _0x3f3254=_0x3f32();return _0x3b3d=function(_0x3b3d4c,_0x43b42a){_0x3b3d4c=_0x3b3d4c-0x1c4;var _0x557739=_0x3f3254[_0x3b3d4c];return _0x557739;},_0x3b3d(_0x4f1cf7,_0x762954);}let validApp=/^([a-zA-Z0-9-_.]{1,100})\/([a-zA-Z0-9-_.]{1,100})$/;function toDefaultApp(_0x528808){var _0x5cd113=_0x9377df;return _0x528808=_0x528808[_0x5cd113(0x203)](validApp),null!==_0x528808?{'ownerName':_0x528808[0x1],'appName':_0x528808[0x2],'identifier':_0x528808[0x1]+'/'+_0x528808[0x2]}:null;}exports[_0x9377df(0x1d8)]=toDefaultApp;let currentProfile=null;function getProfileFilename(){var _0x5d0667=_0x9377df,_0x10096b=misc_1[_0x5d0667(0x1dd)]();return path[_0x5d0667(0x1e5)](_0x10096b,misc_1['profileFile']);}function loadProfile(){var _0x387f20=_0x9377df,_0x377860=getProfileFilename();if(debug('Loading\x20profile\x20from\x20'+_0x377860),!misc_1['fileExistsSync'](_0x377860))return debug(_0x387f20(0x1ec)),null;return debug('Profile\x20file\x20loaded'),(_0x377860=fs[_0x387f20(0x1f1)](_0x377860,'utf8'),_0x377860=JSON['parse'](_0x377860)),new ProfileImpl(_0x377860);}function getUser(){var _0x236d8c=_0x9377df;return debug(_0x236d8c(0x1c4)),currentProfile||(debug(_0x236d8c(0x1c7)),currentProfile=loadProfile()),currentProfile;}function saveUser(_0x106acf,_0x5d3541,_0x36318d,_0x186271){var _0x533891=_0x9377df;return token_store_1[_0x533891(0x1fe)]['set'](_0x106acf[_0x533891(0x1fd)],_0x5d3541)[_0x533891(0x1d0)](()=>{var _0x2d9f78=_0x533891,_0x2167cc=new ProfileImpl(Object[_0x2d9f78(0x1eb)]({},_0x106acf,{'environment':_0x36318d,'tokenSuppliedByUser':_0x186271}));return _0x2167cc[_0x2d9f78(0x1f8)](),_0x2167cc;});}function deleteUser(){return __awaiter(this,void 0x0,void 0x0,function*(){var _0x3ab818=_0x3b3d,_0x4cfb6f=getUser();if(_0x4cfb6f)return _0x4cfb6f[_0x3ab818(0x1e4)]();});}exports[_0x9377df(0x1de)]=getUser,exports[_0x9377df(0x1d1)]=saveUser,exports['deleteUser']=deleteUser;function _0x3f32(){var _0x11acef=['Failed\x20to\x20get\x20token\x20id\x20from\x20profile,\x20error:\x20','defaultApp','toDefaultApp','1kVZTmC','environment','2075LwMcKo','setAccessToken','getProfileDir','getUser','tokenSuppliedByUser','8286TqrpeB','1097806iipHbo','endpoint','path','logout','join','value','token','set','email','writeFileSync','assign','No\x20profile\x20file\x20exists','message','includes','sync','get','readFileSync','defineProperty','422121MdaLpa','656WQTWdY','accessTokenId','351rsRBEA','throw','save','stringify','displayName','userName','Can\x27t\x20get\x20token\x20from\x20tokenStore:\x20','name','tokenStore','remove','10hitxVR','__awaiter','userId','match','Failed\x20to\x20get\x20token\x20from\x20profile,\x20error:\x20','3750057JOHLuK','Getting\x20current\x20user\x20from\x20profile','mkdirp','../misc','No\x20current\x20user,\x20loading\x20from\x20file','debug','could\x20not\x20be\x20found','Fallback\x20to\x20the\x20old\x20name\x20in\x20the\x20keychain.','334536IXXyST','done','760969OQJKLY','12486jlXOSH','apply','then','saveUser','code','./environments','104UfLKme','deleteUser'];_0x3f32=function(){return _0x11acef;};return _0x3f32();}